# MaskSVD: The method using Masknet and SVD(+Kalman filter)

[**Paper**]

Fast posture estimation method using SVD and MaskNet was proposed.
time-series posture estimation still has the problem of fluctuation owing to sensor and inference errors.
To improve the accuracy of posture estimation in realistic task situations, we trained MaskNet on a large dataset of CAD models generated by ray casting, which simulates views from random viewpoints of a sensor model. 
A Kalman filter was also applied to reduce noise in the inference time series.

### Integration of the MaskNet-based Posture estimation method into Robot vision systems:

<p align="center">
      <img src="https://github.com/user-attachments/assets/66977d8f-ea21-4f9d-96a6-0030557f2d76" height="200" width="600" >
</p>


### Processing flow of the proposed method:

<p align="center">
      <video src="https://github.com/user-attachments/assets/7a802523-f403-4a1d-ab53-2fe3e570fcbf" autoplay muted loop autoplay muted>
</p>

### Experiment: 

<p align="center">
      <video src="https://github.com/user-attachments/assets/be980ad2-f0ce-44a3-b8ec-53a2dcfeaf78" autoplay muted loop autoplay muted>
</p>


 
# Installation

CPU only

```bash
pip install numpy
pip install open3d
pip install -U scikit-learn
pip install h5py
pip install torch==2.2.0
pip install tqdm
pip install torchvision
pip install matplotlib
```

GPU

https://pytorch.org/

```bash
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```


# Usage

## MaskSVD(+Kalman filter)

3D sensor is bring up.

```bash
cd ~/<work_space>/
roslaunch realsense2_camera rs_camera.launch enable_pointcloud:=true
```

Preprocessing is executeed.

```bash
cd ~/<work_space>
rosrun mask_svd point_cloud_processor
```

Posture estimation executes.

```bash
cd ~/<work_space>/src/MaskSVD/scripts/
python3 kalman_estimate.py 
```

# Acknowledgement

https://github.com/vinits5/masknet/tree/main

# Author
 
* Yu Iwai
* The University of Kitakyushu
 
# License

This project is release under the MIT License.
