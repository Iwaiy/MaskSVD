# MaskSVD: The method using Masknet and SVD(+Kalman filter)

[**Paper**]

Fast posture estimation method using SVD and MaskNet was proposed.
time-series posture estimation still has the problem of fluctuation owing to sensor and inference errors.
To improve the accuracy of posture estimation in realistic task situations, we trained MaskNet on a large dataset of CAD models generated by ray casting, which simulates views from random viewpoints of a sensor model. 
A Kalman filter was also applied to reduce noise in the inference time series.

### Processing flow of the proposed method:

<p align="center">
      <img src="https://github.com/user-attachments/assets/f7560ade-6a0c-4eea-a27c-76246054ff47" height="200" width="600">
</p>

### Posture estimation: 

<p align="center">
      <video src="https://github.com/user-attachments/assets/a05ac91f-5baa-4228-a74c-b37b6ef6e41c" autoplay muted>
</p>

# Features

The fast global registration and PointNetLK employed to compare the performance of the proposed method.

### A comparison of the time

<p align="center">
      <img src="https://github.com/user-attachments/assets/5b695d36-5611-431c-8b40-84fcbf2d45df" height="350" >
      <img src="https://github.com/user-attachments/assets/aa764a99-f6fc-485b-8f97-0aea9d1406e5" height="400" >
</p>
 
# Installation

CPU only

```bash
pip install numpy
pip install open3d
pip install -U scikit-learn
pip install h5py
pip install torch==2.2.0
pip install tqdm
pip install torchvision
pip install matplotlib
```

GPU

https://pytorch.org/

```bash
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

```bash
git clone https://github.com/Iwaiy/MaskSVD.git
cd MaskSVD
```

# Usage

## Test MaskSVD（Proposed method）and Comparative method for Accuracy

 MaskSVD executes.

```bash
git clone https://github.com/Iwaiy/MaskSVD.git
cd MaskSVD
python3 T-pipe_test.py -s checkpoint/model_weight_epoch300_batchsize32_plane.pth --pattern "A"
```

Fast global registration executes.

```bash
python3 T-pipe_test_jurai_fast.py  --pattern "A"
```

PointNetLK executes.

```bash
python3 T-pipe_test_jurai_ptlk.py  --pattern "A"
```

--pattern "< A or B or C or D >"　can chenge.　

# Acknowledgement

https://github.com/vinits5/masknet/tree/main

# Author
 
* Yu Iwai
* The University of Kitakyushu
 
# License

This project is release under the MIT License.
